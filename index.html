<!DOCTYPE html>
<html lang="en" id="top">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OSS - Open Submission Series</title>
  <meta name="color-scheme" content="dark light" />
  <style>
    /* ===== CSS VARIABLES (Dark Theme) ===== */
    :root{
      --bg: #0c0d10;
      --surface: #111218;
      --surface-2: #171923;
      --text: #e7e9ee;
      --muted: #a1a6b3;
      --accent: #e05024;
      --accent-2: #fff68d;
      --border: #1f2330;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --focus: 0 0 0 3px rgba(122,162,255,.35);
      --radius: 0px; /* square look */
      --container: 1100px;
      --hero-image: url('https://i.imgur.com/Z3bqzqu.jpeg');

      /* Grand Opening palette */
      --go-a: #ff7a18;
      --go-b: #af002d;
      --go-c: #f6d365;
      --go-d: #00e5ff;
      --go-e: #7b61ff;
      --go-glow: 0 0 30px rgba(255,122,24,.55), 0 0 60px rgba(175,0,45,.35);
    }
    @media (prefers-color-scheme: light) {
      :root{ --bg:#f7f8fa; --surface:#ffffff; --surface-2:#f3f5f9; --text:#0f1220; --muted:#4b5160; --border:#e7eaf2; --shadow:0 10px 25px rgba(0,0,0,.08); --focus:0 0 0 3px rgba(62,115,255,.25); }
    }

    /* ===== BASE ===== */
    *,*::before,*::after{ box-sizing: border-box; }
    html{ scroll-behavior:smooth; }
    body{
      margin:0; background:var(--bg); color:var(--text);
      font: 16px/1.6 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    a{ color:var(--text); text-decoration:none; }
    img{ max-width:100%; display:block; }
    .container{ max-width:var(--container); margin-inline:auto; padding: 0 20px; }

    /* ===== NAV (Section 1) ===== */
    .topbar{
      position:sticky; top:0; z-index:1000;
      background:var(--surface); border-bottom:1px solid var(--border); box-shadow: var(--shadow);
    }
    .nav{
      display:flex; align-items:center; justify-content:space-between;
      height:64px; gap:16px;
    }
    .brand{
      display:flex; align-items:center; gap:12px;
    }
    .brand img{
      width:36px; height:36px; border-radius: var(--radius); background:#000; box-shadow: var(--shadow);
    }
    .brand span{ font-weight:600; letter-spacing:.2px; }

    .nav-links{
      position:relative;
      display:flex; gap:18px; align-items:center; transition: height .25s ease;
    }
    .nav-link, .dropdown-toggle{
      padding:8px 10px; border-radius: var(--radius);
      color:var(--muted); background:none; border:none; font:inherit; cursor:pointer;
    }
    .nav-link:hover, .nav-link:focus,
    .dropdown-toggle:hover, .dropdown-toggle:focus{ color:var(--text); outline:none; }
    .nav-link::after, .dropdown-toggle::after{
      content:""; display:block; height:2px; margin-top:6px;
      width:0; background:linear-gradient(90deg,var(--accent),var(--accent-2));
      transition: width .25s ease;
    }
    .nav-link:hover::after, .nav-link:focus-visible::after,
    .dropdown-toggle:hover::after, .dropdown-toggle:focus-visible::after{ width:100%; }

    .burger{
      display:none; background:transparent; border:1px solid var(--border); border-radius: var(--radius);
      width:40px; height:40px; align-items:center; justify-content:center; color:var(--text);
    }
    .burger:focus-visible{ outline: none; box-shadow: var(--focus); }
    .burger svg{ width:22px; height:22px; }

    /* Dropdown */
    .dropdown{ position:relative; }
    .dropdown-toggle{ display:flex; align-items:center; gap:8px; }
    .caret{
      display:inline-block; width:0; height:0; border-left:5px solid transparent; border-right:5px solid transparent;
      border-top:6px solid var(--muted); transition: transform .2s ease, border-top-color .2s ease;
    }
    .dropdown[aria-expanded="true"] .caret{ transform: rotate(180deg); border-top-color: var(--text); }

    .dropdown-menu{
      position:absolute; right:0; top:calc(100% + 8px);
      background:var(--surface-2); border:1px solid var(--border); box-shadow: var(--shadow);
      border-radius: var(--radius); min-width: 220px; padding:6px; display:none;
    }
    .dropdown-menu a{
      display:block; padding:10px; border-radius: var(--radius); color:var(--text);
    }
    .dropdown-menu a:hover, .dropdown-menu a:focus{ background: rgba(255,255,255,.04); outline:none; }

    /* Hover open on pointer devices */
    @media (hover:hover){
      .dropdown:hover .dropdown-menu{ display:block; }
    }

    /* Mobile layout */
    @media (max-width: 820px){
      .burger{ display:inline-flex; }
      .nav-links{
        position:absolute; left:0; right:0; top:64px;
        background:var(--surface); border-bottom:1px solid var(--border);
        flex-direction:column; align-items:flex-start; padding:12px 20px;
        height:0; overflow:hidden;
      }
      .nav-links.open{ height:auto; }
      .nav-link, .dropdown-toggle{ width:100%; text-align:left; padding:12px 6px; }
      .dropdown-menu{
        position:static; display:none; margin:2px 0 8px 0; width:100%;
      }
      .dropdown.open .dropdown-menu{ display:block; }
    }

    /* ===== HERO (Section 2) ===== */
    .hero{
      position:relative; min-height:58vh; display:grid; place-items:center;
      isolation:isolate; background: #000; overflow:hidden;
    }
    .hero::before{
      content:""; position:absolute; inset:0;
      background-image: var(--hero-image);
      background-size: cover; background-position:center;
      filter: brightness(.45) saturate(.9);
      transform: scale(1.05);
      transition: transform 6s ease;
      z-index:-2;
    }
    .hero::after{
      content:""; position:absolute; inset:0; z-index:-1;
      background: radial-gradient(1200px 400px at 60% 10%, transparent 20%, rgba(0,0,0,.4) 55%, rgba(0,0,0,.75) 100%),
                  linear-gradient(180deg, rgba(0,0,0,.3), rgba(0,0,0,.6));
    }
    .hero:hover::before{ transform: scale(1.1); }

    .hero-inner{ text-align:center; padding:80px 20px; }
    .eyebrow{ color:var(--muted); letter-spacing:.25em; text-transform:uppercase; font-size:12px; }
    .hero h1{
      margin:.35em 0 .6em; font-size: clamp(28px, 6vw, 56px);
      line-height:1.1; letter-spacing:.2px;
    }
    .btn{
      display:inline-block; padding:12px 18px; font-weight:600;
      background:linear-gradient(90deg,var(--accent),var(--accent-2));
      color:#0b0e13; border:0; border-radius: var(--radius);
      box-shadow: var(--shadow); transform: translateZ(0);
      transition: transform .15s ease, filter .25s ease, opacity .25s ease;
    }
    .btn:hover{ transform: translateY(-1px); filter: saturate(1.1); }
    .btn:active{ transform: translateY(0); }
    .btn:focus-visible{ outline:none; box-shadow: var(--focus); }

    /* ===== GRAND OPENING (Special Section) ===== */
    .grand-opening{
      position:relative; min-height:92vh; display:grid; place-items:center;
      overflow:hidden; isolation:isolate; background:#050507;
    }
    .grand-opening .go-bg,
    .grand-opening .go-rings{
      position:absolute; inset:-20%;
      filter: blur(30px) saturate(1.1);
      z-index:-2;
      opacity:.75;
    }
    .grand-opening .go-bg{
      background:
        radial-gradient(60% 60% at 30% 20%, color-mix(in oklab, var(--go-a), transparent 35%) 0%, transparent 60%),
        radial-gradient(60% 60% at 70% 30%, color-mix(in oklab, var(--go-b), transparent 35%) 0%, transparent 60%),
        radial-gradient(60% 60% at 50% 80%, color-mix(in oklab, var(--go-e), transparent 45%) 0%, transparent 60%);
      animation: go-shift 18s ease-in-out infinite alternate;
    }
    .grand-opening .go-rings{
      background:
        conic-gradient(from 0deg at 50% 50%, rgba(255,255,255,.08), transparent 40%, rgba(255,255,255,.08)),
        radial-gradient(1200px 1200px at 50% 50%, transparent 40%, rgba(255,255,255,.05) 41%, transparent 42%) repeat;
      mask: radial-gradient(1000px 1000px at 50% 50%, rgba(255,255,255,.35), transparent 60%);
      animation: go-spin 30s linear infinite;
      z-index:-1;
    }
    @keyframes go-spin{ to { transform: rotate(360deg) } }
    @keyframes go-shift{
      0% { transform: translate(-2%, -1%) scale(1.02); }
      100%{ transform: translate(2%, 1%) scale(1.06); }
    }

    .go-inner{ text-align:center; padding: 120px 20px; }
    .go-eyebrow{
      display:inline-block; padding:6px 12px; border:1px solid color-mix(in oklab, var(--accent-2), transparent 55%);
      border-radius:999px; color:var(--accent-2); letter-spacing:.3em; text-transform:uppercase; font-size:11px;
      background: linear-gradient(90deg, rgba(255,255,255,.06), rgba(255,255,255,.0));
      backdrop-filter: blur(4px);
    }
    .go-title{
      margin:.4em 0 .2em;
      font-size: clamp(38px, 9vw, 120px);
      line-height: .95;
      letter-spacing:.5px;
      background: linear-gradient(90deg, var(--go-c), var(--go-a), var(--go-b), var(--go-d), var(--go-e), var(--go-c));
      -webkit-background-clip: text; background-clip: text; color: transparent;
      background-size: 300% 100%;
      animation: go-shine 6s linear infinite;
      text-shadow:
        0 0 1px rgba(255,255,255,.2),
        0 6px 30px rgba(0,0,0,.45);
      filter: drop-shadow(var(--go-glow));
    }
    @keyframes go-shine{
      0%{ background-position: 0% 50%; }
      100%{ background-position: 300% 50%; }
    }
    .go-sub{
      margin: 8px auto 22px; max-width:850px; color: color-mix(in oklab, var(--text), transparent 20%);
      font-size: clamp(16px, 2.4vw, 22px);
    }

    .go-countdown{
      display:inline-grid; grid-template-columns: repeat(4, minmax(72px, 140px)); gap:14px;
      margin: 22px auto 28px;
    }
    .cd-seg{
      position:relative; padding:18px 12px 14px; border:1px solid var(--border); background:rgba(255,255,255,.04);
      box-shadow: var(--shadow); border-radius: 16px;
      overflow:hidden;
    }
    .cd-seg::before{
      content:""; position:absolute; inset:0; pointer-events:none;
      background: radial-gradient(400px 120px at -20% -20%, rgba(255,255,255,.12), transparent 60%),
                  linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.06));
      mix-blend-mode: screen; opacity:.9;
      transform: translateX(-10%); animation: go-sweep 4s ease-in-out infinite;
    }
    @keyframes go-sweep{
      0%,100%{ transform: translateX(-10%); }
      50%{ transform: translateX(10%); }
    }
    .cd-seg .num{
      display:block; font-variant-numeric: tabular-nums; font-weight:800;
      font-size: clamp(28px, 6vw, 48px);
      letter-spacing:.5px;
      text-shadow: 0 8px 30px rgba(0,0,0,.45);
    }
    .cd-seg .lab{
      display:block; margin-top:4px; font-size:12px; color:var(--muted); letter-spacing:.15em; text-transform:uppercase;
    }

    .go-cta{ display:flex; gap:12px; justify-content:center; flex-wrap:wrap; }
    .go-btn{ font-size:16px; padding:14px 20px; }
    .go-btn.outline{
      background: transparent; color: var(--text);
      border:1px solid color-mix(in oklab, var(--accent), transparent 30%);
    }
    .go-btn.outline:hover{ background: rgba(255,255,255,.05); }

    /* Confetti */
    .confetti{
      position:absolute; inset:0; pointer-events:none; overflow:hidden; z-index:2;
    }
    .confetti .piece{
      position:absolute; width:10px; height:16px; opacity:.95;
      will-change: transform;
      border-radius:2px;
      animation: confetti-fall linear forwards, confetti-drift ease-in-out infinite alternate;
    }
    @keyframes confetti-fall{
      0%{ transform: translateY(-10vh) rotate(0deg); }
      100%{ transform: translateY(110vh) rotate(720deg); }
    }
    @keyframes confetti-drift{
      0%{ transform: translateX(-12px) rotateY(0deg); }
      100%{ transform: translateX(12px) rotateY(180deg); }
    }

    /* ===== SECTION TITLES (Section 3) ===== */
    section{ padding: 72px 0; }
    .section-head{ text-align:center; }
    .subtitle{
      color:var(--muted); letter-spacing:.35em; text-transform:uppercase;
      font-size:12px; margin-bottom:10px;
    }
    .title{
      font-size: clamp(24px, 5vw, 44px); line-height:1.15; margin:0 auto 6px;
    }
    .lead{ color:var(--muted); margin:0 auto; max-width: 680px; }

    /* ===== TABLES (Section 4) ===== */
    .tables{
      display:grid; gap:28px; grid-template-columns: 1fr 1fr;
    }
    @media (max-width: 980px){ .tables{ grid-template-columns: 1fr; } }

    .card{
      background:var(--surface-2); border:1px solid var(--border);
      border-radius: var(--radius); box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card header{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:14px 16px; border-bottom:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(0,0,0,.02));
    }
    .card h3{ margin:0; font-size: 16px; letter-spacing:.2px; }
    .hint{ color:var(--muted); font-size:12px; }

    table{ width:100%; border-collapse:collapse; }
    caption{ text-align:left; padding: 0 16px; color:var(--muted); font-size:12px; }
    th, td{ padding: 12px 16px; text-align:left; border-bottom:1px solid var(--border); }
    th{ color:var(--muted); font-weight:600; font-size: 12px; letter-spacing:.08em; text-transform:uppercase; }
    tbody tr{ transition: background .2s ease, transform .2s ease; }
    tbody tr:hover{ background: rgba(255,255,255,.03); }
    tbody tr:active{ transform: scale(.999); }
    .pill{
      display:inline-block; font-size:12px; padding:4px 10px; border:1px solid var(--border);
      border-radius: 999px; color:var(--muted);
    }
    .link{
      color: var(--accent); border-bottom: 1px dashed color-mix(in oklab, var(--accent), transparent 35%);
    }
    .link:hover{ opacity:.9; }
    .empty{ color:var(--muted); padding:18px 16px; }

    /* ===== FOOTER (Section 5) ===== */
    footer{
      background:var(--surface); border-top:1px solid var(--border); margin-top: 64px; padding-left: 10px;
    }
    .footer-grid{
      display:grid; gap:18px; grid-template-columns: 2fr 1fr 1fr;
      padding: 28px 0;
    }
    @media (max-width: 820px){ .footer-grid{ grid-template-columns: 1fr; } }
    .copyright{
      border-top:1px solid var(--border); padding: 14px 0; color:var(--muted); font-size:14px;
    }
    .footer-col h4{ margin:0 0 10px; font-size:14px; text-transform:uppercase; letter-spacing:.15em; color:var(--muted); }
    .footer-col a{ color:var(--text); display:block; padding:6px 0; }
    .footer-col a:hover{ opacity:.9; }

    /* ===== SCROLL REVEAL ===== */
    .reveal{ opacity:0; transform: translateY(16px); transition: opacity .6s ease, transform .6s ease; }
    .reveal.in-view{ opacity:1; transform:none; }
    @media (prefers-reduced-motion: reduce){
      *{ transition: none !important; animation-duration: 0.001ms !important; }
      .hero::before{ transition:none; }
      .reveal{ opacity:1; transform:none; }
      .confetti{ display:none !important; }
      .grand-opening .go-bg,
      .grand-opening .go-rings,
      .go-title{ animation: none !important; }
      .cd-seg::before{ display:none !important; }
    }

    /* ===== UTIL ===== */
    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }
    .space-s{ height: 8px; }
  </style>
</head>
<body>
  <!-- ===== Top Navigation (Section 1) ===== -->
  <header class="topbar" role="banner">
    <div class="container nav" aria-label="Primary">
      <a class="brand" href="#top" aria-label="Home">
        <img alt="Logo"
             src='https://i.imgur.com/XpO73I9.png' />
        <span>OSS</span>
      </a>

      <nav>
        <button class="burger" id="navToggle" aria-expanded="false" aria-controls="navMenu" aria-label="Toggle navigation">
          <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M3 6h18v2H3V6zm0 5h18v2H3v-2zm0 5h18v2H3v-2z"/>
          </svg>
        </button>

        <div id="navMenu" class="nav-links" role="menubar">
          <a class="nav-link" role="menuitem" href="#hero">Home</a>
          <a class="nav-link" role="menuitem" href="#grand-opening">Grand Opening</a>
          <a class="nav-link" role="menuitem" href="#events-head">Events</a>

          <!-- DROPDOWN: Schedule -->
          <div class="dropdown" data-dropdown aria-expanded="false">
            <button class="dropdown-toggle" aria-haspopup="true" aria-expanded="false" aria-controls="menu-schedule">
              Schedule <span class="caret" aria-hidden="true"></span>
            </button>
            <div id="menu-schedule" class="dropdown-menu" role="menu" aria-label="Schedule submenu">
              <a role="menuitem" href="policies.html">Policies</a>
              <a role="menuitem" href="informations.html">Informations</a>
              <a role="menuitem" href="rules.html">Rules</a>
              <a role="menuitem" href="divisions.html">Divisions</a>
            </div>
          </div>

          <a class="nav-link" role="menuitem" href="#footer">Contact</a>
        </div>
      </nav>
    </div>
  </header>

  <!-- ===== Hero (Section 2) ===== -->
  <section id="hero" class="hero">
    <div class="hero-inner container reveal" data-animate="fade">
      <div class="eyebrow">Open Submission Series</div>
      <h1>Fight for your spot.</h1>
      <a class="btn" href="#events-head" role="button">Upcoming Tournaments</a>
    </div>
  </section>

  <!-- ===== Grand Opening (Special Section) ===== -->
  <section id="grand-opening" class="grand-opening" aria-labelledby="grand-opening-title">
    <div class="go-bg" aria-hidden="true"></div>
    <div class="go-rings" aria-hidden="true"></div>
    <div class="confetti" id="confetti" aria-hidden="true"></div>
    <div class="container go-inner">
      <span class="go-eyebrow">Grand Opening</span>
      <h2 class="go-title" id="grand-opening-title">Launch Tournament</h2>
      <p class="go-sub">November 20, 2025 Â· 2:00 AM Â· Right out side the blue store</p>
      <div class="go-countdown" id="go-countdown" aria-live="polite" data-datetime="2025-11-20T01:00:00-04:00">
        <div class="cd-seg"><span class="num" id="cd-days">00</span><span class="lab">Days</span></div>
        <div class="cd-seg"><span class="num" id="cd-hours">00</span><span class="lab">Hours</span></div>
        <div class="cd-seg"><span class="num" id="cd-mins">00</span><span class="lab">Minutes</span></div>
        <div class="cd-seg"><span class="num" id="cd-secs">00</span><span class="lab">Seconds</span></div>
      </div>
      <div class="go-cta">
        <a class="btn go-btn" href="#events-tables" role="button">RSVP Now</a>
        <a class="btn go-btn outline" href="#events-head" role="button">See Full Schedule</a>
      </div>
      <button class="sr-only" id="confettiButton" aria-label="Trigger celebration">Celebrate</button>
    </div>
  </section>

  <!-- ===== Section Intro (Section 3) ===== -->
  <section id="events-head">
    <div class="container section-head reveal" data-animate="fade-up">
      <div class="subtitle">â€“ Events â€“</div>
      <h2 class="title">Near you</h2>
      <p class="lead">Open sign ups, tournaments.</p>
    </div>
  </section>

  <!-- ===== Event Tables (Section 4) ===== -->
  <section id="events-tables">
    <div class="container tables">
      <!-- Upcoming -->
      <article class="card reveal" data-animate="fade-up">
        <header>
          <h3>Upcoming Events</h3>
          <span class="hint">Auto-sorted by date</span>
        </header>
        <table aria-describedby="upcoming-caption">
          <thead>
            <tr>
              <th scope="col">Date</th>
              <th scope="col">Event</th>
              <th scope="col">Location</th>
              <th scope="col">Details</th>
            </tr>
          </thead>
          <tbody id="upcoming-body">
            <tr>
              <td colspan="4" class="empty">Loading upcoming eventsâ€¦</td>
            </tr>
          </tbody>
        </table>
      </article>

      <!-- Previous -->
      <article class="card reveal" data-animate="fade-up">
        <header>
          <h3>Previous Events</h3>
          <span class="hint">Most recent first</span>
        </header>
        <table aria-describedby="previous-caption">
          <thead>
            <tr>
              <th scope="col">Date</th>
              <th scope="col">Event</th>
              <th scope="col">Location</th>
              <th scope="col">Recap</th>
            </tr>
          </thead>
        <tbody id="previous-body">
            <tr>
              <td colspan="4" class="empty">Loading previous eventsâ€¦</td>
            </tr>
          </tbody>
        </table>
      </article>
    </div>
  </section>

  <!-- ===== Footer (Section 5) ===== -->
  <footer id="footer">
    <div class="container footer-grid reveal" data-animate="fade-up">
      <div class="footer-col">
        <h4>About</h4>
        <p class="lead">OSS is ___.</p>
      </div>
      <div class="footer-col">
        <h4>Links</h4>
        <a href="#hero">Home</a>
        <a href="#events-head">Events</a>
        <a href="#events-tables">Schedule</a>
      </div>
      <div class="footer-col">
        <h4>Contact</h4>
        <a href="mailto:info@example.com" class="link">info@example.com</a>
        <span class="space-s"></span>
        <span class="pill">Monâ€“Sun Â· 9â€“5</span>
      </div>
    </div>
    <div class="container copyright">
      Â© <span id="year"></span> OSS. All rights reserved.
    </div>
  </footer>

  <!-- ===== JS (Nav, Dropdowns, Scroll Reveal, Events Render) ===== -->
  <script>
    /* ------------------------------
     * 1) MOBILE NAV TOGGLE
     * ------------------------------ */
    (function(){
      const toggle = document.getElementById('navToggle');
      const menu = document.getElementById('navMenu');

      const closeMenu = () => {
        menu.classList.remove('open');
        toggle.setAttribute('aria-expanded', 'false');
        // Close any open dropdowns on collapse
        document.querySelectorAll('[data-dropdown].open').forEach(d => {
          d.classList.remove('open');
          d.setAttribute('aria-expanded','false');
          d.querySelector('.dropdown-toggle')?.setAttribute('aria-expanded','false');
        });
      };

      toggle.addEventListener('click', () => {
        const open = menu.classList.toggle('open');
        toggle.setAttribute('aria-expanded', String(open));
      });

      // Close on link click (mobile)
      menu.addEventListener('click', (e) => {
        const isLink = e.target.closest('a.nav-link');
        if (isLink && window.matchMedia('(max-width: 820px)').matches) {
          closeMenu();
        }
      });

      // Close on outside click (mobile)
      document.addEventListener('click', (e) => {
        if (!menu.contains(e.target) && !toggle.contains(e.target)) {
          if (window.matchMedia('(max-width: 820px)').matches) closeMenu();
        }
      });
    })();

    /* ------------------------------
     * 2) ACCESSIBLE DROPDOWNS
     *    - Click to toggle (works on mobile)
     *    - Hover via CSS on desktop
     *    - Escape closes
     *    - Arrow keys navigate menu items
     * ------------------------------ */
    (function(){
      const dropdowns = document.querySelectorAll('[data-dropdown]');
      const isMobile = () => window.matchMedia('(max-width: 820px)').matches;

      dropdowns.forEach(drop => {
        const btn = drop.querySelector('.dropdown-toggle');
        const menu = drop.querySelector('.dropdown-menu');
        const items = Array.from(menu.querySelectorAll('a'));

        function open(){
          drop.classList.add('open');
          drop.setAttribute('aria-expanded','true');
          btn.setAttribute('aria-expanded','true');
          // On mobile, ensure menu is visible via class
          if (isMobile()) menu.style.display = 'block';
        }
        function close(){
          drop.classList.remove('open');
          drop.setAttribute('aria-expanded','false');
          btn.setAttribute('aria-expanded','false');
          if (isMobile()) menu.style.display = 'none';
        }
        function toggle(){
          (drop.classList.contains('open')) ? close() : open();
        }

        // Click toggling (mobile & desktop fallback)
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          // Close other open dropdowns (mobile)
          if (isMobile()){
            document.querySelectorAll('[data-dropdown].open').forEach(d => { if(d!==drop) d.classList.remove('open'); });
          }
          toggle();
        });

        // Keyboard support
        btn.addEventListener('keydown', (e) => {
          if (e.key === 'ArrowDown'){ e.preventDefault(); open(); items[0]?.focus(); }
        });

        menu.addEventListener('keydown', (e) => {
          const i = items.indexOf(document.activeElement);
          if (e.key === 'Escape'){ e.preventDefault(); close(); btn.focus(); }
          if (e.key === 'ArrowDown'){ e.preventDefault(); items[Math.min(i+1, items.length-1)]?.focus(); }
          if (e.key === 'ArrowUp'){ e.preventDefault(); items[Math.max(i-1, 0)]?.focus(); }
          if (e.key === 'Home'){ e.preventDefault(); items[0]?.focus(); }
          if (e.key === 'End'){ e.preventDefault(); items[items.length-1]?.focus(); }
        });

        // Click outside to close
        document.addEventListener('click', (e) => {
          if (!drop.contains(e.target) && drop.classList.contains('open') && isMobile()){
            close();
          }
        });

        // Focus-out close (desktop hover users navigating with keyboard)
        drop.addEventListener('focusout', (e) => {
          // If focus leaves dropdown entirely, close
          if (!drop.contains(e.relatedTarget) && !isMobile()){
            close();
          }
        });
      });
    })();

    /* ------------------------------
     * 3) SCROLL REVEAL (IntersectionObserver)
     * ------------------------------ */
    (function(){
      const items = document.querySelectorAll('.reveal');
      if ('IntersectionObserver' in window) {
        const io = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('in-view');
              io.unobserve(entry.target);
            }
          });
        }, { threshold: 0.3 });
        items.forEach(el => io.observe(el));
      } else {
        items.forEach(el => el.classList.add('in-view'));
      }
    })();

    /* ------------------------------
     * 4) EVENTS DATA + RENDERING
     * ------------------------------ */
    const events = [
      { date: '2025-09-12', title: 'District Championship', location: 'Downtown Ft Myers', url: '#' },
      { date: '2025-10-05', title: 'Roll around the wings', location: 'Blue store', url: '#' },
      { date: '2025-11-22', title: 'Sign ups and Meet & Greet', location: 'Edison Mall', url: '#' },
      { date: '2025-07-18', title: 'District Championship', location: 'Cape High School', url: '#' },
      { date: '2025-06-02', title: 'Community Blood Drive Tournament', location: 'Scoops & Treats', url: '#' },
    ];

    function formatDate(iso){
      const d = new Date(iso + 'T12:00:00');
      if (Number.isNaN(d.getTime())) return iso;
      return new Intl.DateTimeFormat(undefined, { year:'numeric', month:'short', day:'2-digit' }).format(d);
    }

    function renderTables(){
      const upcomingBody = document.getElementById('upcoming-body');
      const previousBody = document.getElementById('previous-body');

      upcomingBody.innerHTML = '';
      previousBody.innerHTML = '';

      const today = new Date(); today.setHours(0,0,0,0);

      const upcoming = [], previous = [];
      for (const ev of events){
        const d = new Date(ev.date + 'T00:00:00');
        if (!Number.isNaN(d.getTime()) && d >= today) upcoming.push(ev);
        else previous.push(ev);
      }

      upcoming.sort((a,b)=> a.date.localeCompare(b.date));
      previous.sort((a,b)=> b.date.localeCompare(a.date));

      const row = (ev) => {
        const safeTitle = ev.title || 'Untitled';
        const safeLoc = ev.location || 'â€”';
        const safeUrl = ev.url || '#';
        const display = formatDate(ev.date);

        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><time datetime="${ev.date}">${display}</time></td>
          <td>${safeTitle}</td>
          <td>${safeLoc}</td>
          <td><a class="link" href="${safeUrl}" target="_blank" rel="noopener">View</a></td>
        `;
        return tr;
      };

      if (upcoming.length === 0){
        upcomingBody.innerHTML = `<tr><td colspan="4" class="empty">No upcoming events yet. Check back soon.</td></tr>`;
      } else {
        upcoming.forEach(ev => upcomingBody.appendChild(row(ev)));
      }

      if (previous.length === 0){
        previousBody.innerHTML = `<tr><td colspan="4" class="empty">No previous events on record.</td></tr>`;
      } else {
        previous.forEach(ev => previousBody.appendChild(row(ev)));
      }
    }
    renderTables();

    /* ------------------------------
     * 5) MISC
     * ------------------------------ */
    document.getElementById('year').textContent = new Date().getFullYear();

    // Improve hash focus for accessibility on smooth scroll
    (function(){
      function focusHashTarget(){
        const id = location.hash.slice(1);
        if(!id) return;
        const el = document.getElementById(id);
        if(el){ el.setAttribute('tabindex','-1'); el.focus({ preventScroll:true }); el.addEventListener('blur', ()=> el.removeAttribute('tabindex'), { once:true }); }
      }
      window.addEventListener('hashchange', focusHashTarget);
    })();

    /* ------------------------------
     * 6) GRAND OPENING: Confetti + Countdown + Activation
     * ------------------------------ */
    (function(){
      const section = document.getElementById('grand-opening');
      const confettiWrap = document.getElementById('confetti');
      const triggerBtn = document.getElementById('confettiButton');
      const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      // Colors for confetti pieces
      const colors = ['#ff7a18','#af002d','#f6d365','#00e5ff','#7b61ff','#fff68d','#e05024'];

      function makePiece(width, height){
        const el = document.createElement('span');
        el.className = 'piece';
        const w = Math.max(6, Math.min(14, Math.floor(width || (6 + Math.random()*10))));
        const h = Math.max(8, Math.min(18, Math.floor(height || (8 + Math.random()*12))));
        el.style.width = w + 'px';
        el.style.height = h + 'px';
        el.style.left = Math.floor(Math.random()*100) + 'vw';
        el.style.top = '-10vh';
        el.style.background = colors[Math.floor(Math.random()*colors.length)];
        el.style.animationDuration = (6 + Math.random()*5) + 's, ' + (2 + Math.random()*2.5) + 's';
        el.style.animationDelay = (Math.random()*1.2) + 's, ' + (Math.random()*1) + 's';
        el.style.transform = 'translateY(-10vh) rotate(0deg)';
        return el;
      }

      function burst(count=120){
        if (prefersReduced) return;
        const frag = document.createDocumentFragment();
        for (let i=0;i<count;i++){
          frag.appendChild(makePiece());
        }
        confettiWrap.appendChild(frag);
        // Clean up pieces after animation ends
        setTimeout(() => {
          confettiWrap.querySelectorAll('.piece').forEach(p => p.remove());
        }, 13000);
      }

      // Activate burst when section enters view
      if ('IntersectionObserver' in window){
        const io = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting){
              burst(160);
              io.unobserve(entry.target);
            }
          });
        }, { threshold: 0.5 });
        io.observe(section);
      } else {
        // Fallback
        burst(140);
      }

      // Manual re-burst on click/tap
      section.addEventListener('click', () => burst(80));
      triggerBtn.addEventListener('click', (e) => { e.preventDefault(); burst(100); });

      // Countdown
      const cdRoot = document.getElementById('go-countdown');
      function pad(n){ return String(n).padStart(2,'0'); }
      function updateCountdown(){
        if (!cdRoot) return;
        const iso = cdRoot.getAttribute('data-datetime');
        const target = new Date(iso);
        const now = new Date();
        const diff = target - now;
        const daysEl = document.getElementById('cd-days');
        const hoursEl = document.getElementById('cd-hours');
        const minsEl = document.getElementById('cd-mins');
        const secsEl = document.getElementById('cd-secs');

        if (Number.isNaN(target.getTime())){
          daysEl.textContent = '00';
          hoursEl.textContent = '00';
          minsEl.textContent = '00';
          secsEl.textContent = '00';
          return;
        }

        if (diff <= 0){
          cdRoot.innerHTML = '<div class="cd-seg"><span class="num">ðŸŽ‰</span><span class="lab">We\'re Open!</span></div>';
          return;
        }

        const d = Math.floor(diff / (1000*60*60*24));
        const h = Math.floor((diff / (1000*60*60)) % 24);
        const m = Math.floor((diff / (1000*60)) % 60);
        const s = Math.floor((diff / 1000) % 60);

        daysEl.textContent = pad(d);
        hoursEl.textContent = pad(h);
        minsEl.textContent = pad(m);
        secsEl.textContent = pad(s);
      }
      updateCountdown();
      setInterval(updateCountdown, 1000);
    })();
  </script>
</body>
</html>
